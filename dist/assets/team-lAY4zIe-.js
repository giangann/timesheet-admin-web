import{j as e,B as g,T as y,r as o,d as $,a as u,I,c as P,P as q,M as z,m as N,b as E,u as Q,e as U,D as J,S as K,H as Y}from"./index-q_5Tqw1q.js";import{C as Z}from"./config-global-ClKwKbZP.js";import{T as R,a as f,b as _,C as L,c as V,d as A,D,e as W,f as ee,g as ne,h as se,i as te}from"./Tooltip-BgB3WJCz.js";import{O as ae,T as H}from"./TextField-DUkHxIjn.js";import{I as oe}from"./InputAdornment-CtwGFzN6.js";import{D as M,a as F}from"./dialogTitleClasses-B08oaWpB.js";import{G as T,C as re}from"./Grid-CdEE13BC.js";import{u as le}from"./index.esm-DVunts-Q.js";import{a as ie,b as ce,u as de}from"./use-team-D5xhiK3a.js";import{p as he,h as xe}from"./object-util-B_4fPfHZ.js";import"./use-api-DWFDTJE-.js";import"./map-util-BcGf2YPr.js";function ue({emptyRows:n,height:a,sx:t,...l}){return n?e.jsx(R,{sx:{...a&&{height:a*n},...t},...l,children:e.jsx(f,{colSpan:9})}):null}function me({searchQuery:n,...a}){return e.jsx(R,{...a,children:e.jsx(f,{align:"center",colSpan:7,children:e.jsxs(g,{sx:{py:15,textAlign:"center"},children:[e.jsx(y,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(y,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}const pe={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function ge(n,a,t){return n?Math.max(0,(1+n)*a-t):0}function G(n,a,t){return a[t]<n[t]?-1:a[t]>n[t]?1:0}function je(n,a){return n==="desc"?(t,l)=>G(t,l,a):(t,l)=>-G(t,l,a)}function be({inputData:n,comparator:a,filterName:t}){const l=n.map((c,i)=>[c,i]);return l.sort((c,i)=>{const s=a(c[0],i[0]);return s!==0?s:c[1]-i[1]}),n=l.map(c=>c[0]),t&&(n=n.filter(c=>c.name.toLowerCase().indexOf(t.toLowerCase())!==-1)),n}function fe({order:n,onSort:a,orderBy:t,rowCount:l,headLabel:c,numSelected:i,onSelectAllRows:s}){return e.jsx(_,{children:e.jsxs(R,{children:[e.jsx(f,{padding:"checkbox",children:e.jsx(L,{indeterminate:i>0&&i<l,checked:l>0&&i===l,onChange:r=>s(r.target.checked)})}),c.map(r=>e.jsx(f,{align:r.align||"left",sortDirection:t===r.id?n:!1,sx:{width:r.width,minWidth:r.minWidth},children:e.jsxs(V,{hideSortIcon:!0,active:t===r.id,direction:t===r.id?n:"asc",onClick:()=>a(r.id),children:[r.label,t===r.id?e.jsx(g,{sx:{...pe},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))]})})}function Ce({numSelected:n,onMultiDelete:a,filterName:t,onFilterName:l}){const[c,i]=o.useState(!1),s=o.useCallback(()=>{i(!0)},[i]),r=o.useCallback(()=>{i(!1)},[i]),m=o.useCallback(()=>{r(),a==null||a()},[r,a]);return e.jsxs($,{sx:{height:96,display:"flex",justifyContent:"space-between",p:p=>p.spacing(0,1,0,3),...n>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[n>0?e.jsxs(y,{component:"div",variant:"subtitle1",children:[n," selected"]}):e.jsx(ae,{fullWidth:!0,value:t,onChange:l,placeholder:"Tìm theo tên phòng ban...",startAdornment:e.jsx(oe,{position:"start",children:e.jsx(u,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),n>0&&e.jsx(A,{title:"Delete",children:e.jsx(I,{onClick:s,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(M,{open:c,onClose:r,children:e.jsxs(g,{sx:{p:4,pb:4},children:[e.jsxs(g,{position:"relative",children:[e.jsx(D,{sx:{textAlign:"left"},children:"Xác nhận xóa?"}),e.jsx(g,{position:"absolute",top:"15%",right:0,children:e.jsx(A,{title:"Đóng",children:e.jsx(I,{onClick:r,children:e.jsx(u,{icon:"material-symbols:close"})})})})]}),e.jsx(T,{container:!0,rowGap:3,children:e.jsx(T,{item:!0,xs:12,children:e.jsxs(W,{sx:{mb:1},children:["Xác nhận xóa ",n," bản ghi"]})})}),e.jsxs(F,{children:[e.jsx(P,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:discard"}),onClick:r,children:"Hủy"}),e.jsx(P,{variant:"contained",color:"error",startIcon:e.jsx(u,{icon:"material-symbols:delete"}),onClick:m,children:"Xóa"})]})]})})]})}function ke({row:n,selected:a,onSelectRow:t,onDeleteTeam:l,onGotoDetail:c}){const[i,s]=o.useState(null),[r,m]=o.useState(!1),p=o.useCallback(h=>{s(h.currentTarget)},[]),x=o.useCallback(()=>{s(null)},[]),C=o.useCallback(()=>{m(!0)},[m]),j=o.useCallback(()=>{m(!1)},[m]),k=o.useCallback(()=>{x(),C()},[x,C]),w=o.useCallback(()=>{x(),c(n)},[x,c,n]),S=o.useCallback(()=>{j(),l(n)},[j,l,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(R,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,children:[e.jsx(f,{padding:"checkbox",children:e.jsx(L,{disableRipple:!0,checked:a,onChange:t})}),e.jsx(f,{children:n.name}),e.jsx(f,{children:n.hotline??"-"}),e.jsx(f,{align:"right",children:e.jsx(I,{onClick:p,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(q,{open:!!i,anchorEl:i,onClose:x,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(z,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${N.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${N.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(E,{onClick:w,children:[e.jsx(u,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(E,{onClick:k,sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(M,{open:r,onClose:j,children:e.jsxs(g,{sx:{p:4,pb:4},children:[e.jsxs(g,{position:"relative",children:[e.jsx(D,{sx:{textAlign:"left"},children:"Xác nhận xóa?"}),e.jsx(g,{position:"absolute",top:"15%",right:0,children:e.jsx(A,{title:"Đóng",children:e.jsx(I,{onClick:j,children:e.jsx(u,{icon:"material-symbols:close"})})})})]}),e.jsx(T,{container:!0,rowGap:3,children:e.jsx(T,{item:!0,xs:12,children:e.jsxs(W,{sx:{mb:1},children:["Xác nhận xóa ",n.name,":"]})})}),e.jsxs(F,{children:[e.jsx(P,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:discard"}),onClick:j,children:"Hủy"}),e.jsx(P,{variant:"contained",color:"error",startIcon:e.jsx(u,{icon:"material-symbols:delete"}),onClick:S,children:"Xóa"})]})]})})]})}function Te(){const[n,a]=o.useState(!1),[t,l]=o.useState(""),{enqueueSnackbar:c}=Q(),i=U(),s=Se(),{deleteTeamById:r}=ie(),{onCreateNewTeam:m}=ce(),{teams:p,onFetchTeams:x}=de(),C=be({inputData:p,comparator:je(s.order,s.orderBy),filterName:t}),j=!C.length&&!!t,k=o.useCallback(d=>{i.push(`/phong-ban/${d.id}`)},[i]),w=o.useCallback(d=>{s.onSelectAllRows(d,p.map(v=>v.id.toString()))},[p,s]),S=o.useCallback(()=>{s.onSelectAllRows(!1,[])},[s]),h=o.useCallback(async d=>{await r(d.id),x()},[r,x]),b=o.useCallback(async d=>{await r(d),x()},[r,x]),O=o.useCallback(()=>{s.selected.forEach(v=>b(parseInt(v,10))),S()},[b,s,S]),X=o.useCallback(async d=>{const v=he(d,["name"]);if(xe(v)){c("Tên không được để trống",{variant:"warning"});return}const B={hotline:d.hotline??"",name:d.name??""};await m(B),x(),a(!1)},[x,m,c,a]);return e.jsxs(J,{children:[e.jsxs(g,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(y,{variant:"h4",flexGrow:1,children:"Phòng ban"}),e.jsx(P,{variant:"contained",color:"inherit",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),onClick:()=>a(!0),children:"Thêm mới"})]}),e.jsxs(re,{children:[e.jsx(Ce,{numSelected:s.selected.length,filterName:t,onFilterName:d=>{l(d.target.value),s.onResetPage()},onMultiDelete:O}),e.jsx(K,{children:e.jsx(ee,{sx:{overflow:"unset"},children:e.jsxs(ne,{sx:{minWidth:800},children:[e.jsx(fe,{order:s.order,orderBy:s.orderBy,rowCount:p.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:w,headLabel:[{id:"name",label:"Tên phòng ban"},{id:"hotline",label:"Hotline"},{id:""}]}),e.jsxs(se,{children:[C.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(d=>e.jsx(ke,{row:d,selected:s.selected.includes(d.id.toString()),onSelectRow:()=>s.onSelectRow(d.id.toString()),onDeleteTeam:h,onGotoDetail:k},d.id.toString())),e.jsx(ue,{height:68,emptyRows:ge(s.page,s.rowsPerPage,p.length)}),j&&e.jsx(me,{searchQuery:t})]})]})})}),e.jsx(te,{component:"div",page:s.page,count:p.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,rowsPerPageOptions:[5,15,25,p.length],onRowsPerPageChange:s.onChangeRowsPerPage}),n&&e.jsx(Pe,{cb:X,dialogProps:{open:n,onClose:()=>a(!1)}})]})]})}const Pe=({dialogProps:n,cb:a})=>{const{register:t,handleSubmit:l,formState:{isSubmitting:c}}=le();return e.jsx(M,{...n,children:e.jsxs(g,{px:{xs:2,md:4},pb:{xs:3,md:6},pt:{xs:1,md:2},children:[e.jsx(D,{sx:{pl:.5,mb:{xs:1,md:2}},children:"Tạo phòng ban mới"}),e.jsxs(T,{container:!0,spacing:{xs:0,md:2},children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(H,{...t("name"),label:"Tên phòng ban",placeholder:"Nhập tên",fullWidth:!0,required:!0,InputLabelProps:{shrink:!0},sx:{mb:3}})}),e.jsx(T,{item:!0,xs:12,md:6,children:e.jsx(H,{...t("hotline"),label:"Hotline",placeholder:"Nhập hotline",fullWidth:!0,InputLabelProps:{shrink:!0},sx:{mb:3}})})]}),e.jsxs(F,{sx:{pr:0},children:[e.jsx(P,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:close"}),onClick:i=>{var s;return(s=n.onClose)==null?void 0:s.call(n,i,"backdropClick")},children:"Đóng"}),e.jsx(P,{variant:"contained",startIcon:e.jsx(u,{icon:"material-symbols:add"}),onClick:l(a),disabled:c,children:"Tạo".padEnd(5)})]})]})})};function Se(){const[n,a]=o.useState(0),[t,l]=o.useState("name"),[c,i]=o.useState(5),[s,r]=o.useState([]),[m,p]=o.useState("asc"),x=o.useCallback(h=>{p(t===h&&m==="asc"?"desc":"asc"),l(h)},[m,t]),C=o.useCallback((h,b)=>{if(h){r(b);return}r([])},[]),j=o.useCallback(h=>{const b=s.includes(h)?s.filter(O=>O!==h):[...s,h];r(b)},[s]),k=o.useCallback(()=>{a(0)},[]),w=o.useCallback((h,b)=>{a(b)},[]),S=o.useCallback(h=>{i(parseInt(h.target.value,10)),k()},[k]);return{page:n,order:m,onSort:x,orderBy:t,selected:s,rowsPerPage:c,onSelectRow:j,onResetPage:k,onChangePage:w,onSelectAllRows:C,onChangeRowsPerPage:S}}function He(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsxs("title",{children:[" ",`Phòng ban - ${Z.appName}`]})}),e.jsx(Te,{})]})}export{He as default};
