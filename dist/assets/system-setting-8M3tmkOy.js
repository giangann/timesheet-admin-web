import{j as e,B as j,r,w as F,I as D,a as u,P as $,M as q,m as N,b as E,c as v,d as z,T,u as Q,e as U,D as Y,S as V,t as J,H as K}from"./index-C8lk817k.js";import{C as Z}from"./config-global-ClKwKbZP.js";import{u as _,C as ee}from"./index.esm-Y5GXLdwH.js";import{u as ne,a as se,b as te}from"./useBaseSalary-Dpyob9SO.js";import{p as ae,h as oe}from"./object-util-B_4fPfHZ.js";import{b as re,T as I,a as f,C as H,c as le,D as B,d as M,e as L,f as ie,g as ce,h as de,i as he}from"./Tooltip-BFas_5jx.js";import{D as O,a as A}from"./dialogTitleClasses-B-ld9CFH.js";import{G as S,C as xe}from"./Grid-CuOb3N_t.js";import{O as ue,T as pe}from"./TextField-7QqntMl9.js";import{I as ge}from"./InputAdornment-DNg53QyW.js";import{D as je}from"./DatePicker-BrttOUye.js";import"./use-api--dau0ow6.js";import"./colorManipulator-3ZubZ_tq.js";const me={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function be(n,o,t){return n?Math.max(0,(1+n)*o-t):0}function G(n,o,t){return o[t]<n[t]?-1:o[t]>n[t]?1:0}function fe(n,o){return n==="desc"?(t,i)=>G(t,i,o):(t,i)=>-G(t,i,o)}function Ce({inputData:n,comparator:o,filterName:t}){const i=n.map((d,c)=>[d,c]);return i.sort((d,c)=>{const l=o(d[0],c[0]);return l!==0?l:d[1]-c[1]}),n=i.map(d=>d[0]),t&&(n=n.filter(d=>d.effectiveDate.toLowerCase().indexOf(t.toLowerCase())!==-1)),n}function ke({order:n,onSort:o,orderBy:t,rowCount:i,headLabel:d,numSelected:c,onSelectAllRows:l}){return e.jsx(re,{children:e.jsxs(I,{children:[e.jsx(f,{padding:"checkbox",children:e.jsx(H,{indeterminate:c>0&&c<i,checked:i>0&&c===i,onChange:s=>l(s.target.checked)})}),d.map(s=>e.jsx(f,{align:s.align||"left",sortDirection:t===s.id?n:!1,sx:{width:s.width,minWidth:s.minWidth},children:e.jsxs(le,{hideSortIcon:!0,active:t===s.id,direction:t===s.id?n:"asc",onClick:()=>o(s.id),children:[s.label,t===s.id?e.jsx(j,{sx:{...me},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},s.id))]})})}function Se({row:n,selected:o,onSelectRow:t,onDeleteBaseSalary:i,onGotoDetail:d}){const[c,l]=r.useState(null),[s,p]=r.useState(!1),g=r.useCallback(x=>{l(x.currentTarget)},[]),a=r.useCallback(()=>{l(null)},[]),C=r.useCallback(()=>{p(!0)},[p]),m=r.useCallback(()=>{p(!1)},[p]),k=r.useCallback(()=>{a(),C()},[a,C]),w=r.useCallback(()=>{a(),d(n)},[a,d,n]),y=r.useCallback(()=>{m(),i(n)},[m,i,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(I,{hover:!0,tabIndex:-1,role:"checkbox",selected:o,children:[e.jsx(f,{padding:"checkbox",children:e.jsx(H,{disableRipple:!0,checked:o,onChange:t})}),e.jsx(f,{children:F(new Date(n.effectiveDate),"DD/MM/YYYY")}),e.jsx(f,{children:n.value}),e.jsx(f,{align:"right",children:e.jsx(D,{onClick:g,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})]}),e.jsx($,{open:!!c,anchorEl:c,onClose:a,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(q,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${N.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${N.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(E,{onClick:w,children:[e.jsx(u,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(E,{onClick:k,sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(O,{open:s,onClose:m,children:e.jsxs(j,{sx:{p:4,pb:4},children:[e.jsxs(j,{position:"relative",children:[e.jsx(B,{sx:{textAlign:"left"},children:"Xác nhận xóa?"}),e.jsx(j,{position:"absolute",top:"15%",right:0,children:e.jsx(M,{title:"Đóng",children:e.jsx(D,{onClick:m,children:e.jsx(u,{icon:"material-symbols:close"})})})})]}),e.jsx(S,{container:!0,rowGap:3,children:e.jsx(S,{item:!0,xs:12,children:e.jsxs(L,{sx:{mb:1},children:["Xác nhận xóa bản ghi có hiệu lực từ"," ",F(new Date(n.effectiveDate),"DD/MM/YYYY"),":"]})})}),e.jsxs(A,{children:[e.jsx(v,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:discard"}),onClick:m,children:"Hủy"}),e.jsx(v,{variant:"contained",color:"error",startIcon:e.jsx(u,{icon:"material-symbols:delete"}),onClick:y,children:"Xóa"})]})]})})]})}function ve({numSelected:n,onMultiDelete:o,filterName:t,onFilterName:i}){const[d,c]=r.useState(!1),l=r.useCallback(()=>{c(!0)},[c]),s=r.useCallback(()=>{c(!1)},[c]),p=r.useCallback(()=>{s(),o==null||o()},[s,o]);return e.jsxs(z,{sx:{height:96,display:"flex",justifyContent:"space-between",p:g=>g.spacing(0,1,0,3),...n>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[n>0?e.jsxs(T,{component:"div",variant:"subtitle1",children:[n," selected"]}):e.jsx(ue,{fullWidth:!0,value:t,onChange:i,placeholder:"Tìm theo ngày hiệu lực...",startAdornment:e.jsx(ge,{position:"start",children:e.jsx(u,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),n>0&&e.jsx(M,{title:"Delete",children:e.jsx(D,{onClick:l,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(O,{open:d,onClose:s,children:e.jsxs(j,{sx:{p:4,pb:4},children:[e.jsxs(j,{position:"relative",children:[e.jsx(B,{sx:{textAlign:"left"},children:"Xác nhận xóa?"}),e.jsx(j,{position:"absolute",top:"15%",right:0,children:e.jsx(M,{title:"Đóng",children:e.jsx(D,{onClick:s,children:e.jsx(u,{icon:"material-symbols:close"})})})})]}),e.jsx(S,{container:!0,rowGap:3,children:e.jsx(S,{item:!0,xs:12,children:e.jsxs(L,{sx:{mb:1},children:["Xác nhận xóa ",n," bản ghi"]})})}),e.jsxs(A,{children:[e.jsx(v,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:discard"}),onClick:s,children:"Hủy"}),e.jsx(v,{variant:"contained",color:"error",startIcon:e.jsx(u,{icon:"material-symbols:delete"}),onClick:p,children:"Xóa"})]})]})})]})}function ye({emptyRows:n,height:o,sx:t,...i}){return n?e.jsx(I,{sx:{...o&&{height:o*n},...t},...i,children:e.jsx(f,{colSpan:9})}):null}function we({searchQuery:n,...o}){return e.jsx(I,{...o,children:e.jsx(f,{align:"center",colSpan:7,children:e.jsxs(j,{sx:{py:15,textAlign:"center"},children:[e.jsx(T,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(T,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function Pe(){const[n,o]=r.useState(!1),[t,i]=r.useState(""),{enqueueSnackbar:d}=Q(),c=U(),{baseSalaries:l,onFetchBaseSalaries:s}=ne(),{onCreateNewBaseSalary:p}=se(),{deleteBaseSalaryById:g}=te(),a=Te(),C=Ce({inputData:l,comparator:fe(a.order,a.orderBy),filterName:t}),m=!C.length&&!!t,k=r.useCallback(h=>{c.push(`/cai-dat-he-thong/luong-co-ban/${h.id}`)},[c]),w=r.useCallback(async h=>{await g(h.id),s()},[g,s]),y=r.useCallback(async h=>{await g(h),s()},[g,s]),x=r.useCallback(h=>{a.onSelectAllRows(h,l.map(P=>P.id.toString()))},[l,a]),b=r.useCallback(()=>{a.onSelectAllRows(!1,[])},[a]),R=r.useCallback(()=>{a.selected.forEach(P=>y(parseInt(P,10))),b()},[y,a,b]),W=r.useCallback(async h=>{const P=ae(h,["value","effectiveDate"]);if(oe(P)){d("Tên không được để trống",{variant:"warning"});return}const X={value:h.value??0,effectiveDate:h.effectiveDate??""};await p(X),s(),o(!1)},[s,p,d,o]);return e.jsxs(Y,{children:[e.jsxs(j,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(T,{variant:"h4",flexGrow:1,children:"Mức lương cơ bản"}),e.jsx(v,{variant:"contained",color:"inherit",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),onClick:()=>o(!0),children:"Thêm mới"})]}),e.jsxs(xe,{children:[e.jsx(ve,{numSelected:a.selected.length,filterName:t,onFilterName:h=>{i(h.target.value),a.onResetPage()},onMultiDelete:R}),e.jsx(V,{children:e.jsx(ie,{sx:{overflow:"unset"},children:e.jsxs(ce,{sx:{minWidth:800},children:[e.jsx(ke,{order:a.order,orderBy:a.orderBy,rowCount:l.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:x,headLabel:[{id:"effectiveDate",label:"Ngày hiệu lực"},{id:"value",label:"Giá trị"},{id:""}]}),e.jsxs(de,{children:[C.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(h=>e.jsx(Se,{row:h,selected:a.selected.includes(h.id.toString()),onSelectRow:()=>a.onSelectRow(h.id.toString()),onDeleteBaseSalary:w,onGotoDetail:k},h.id.toString())),e.jsx(ye,{height:68,emptyRows:be(a.page,a.rowsPerPage,l.length)}),m&&e.jsx(we,{searchQuery:t})]})]})})}),e.jsx(he,{component:"div",page:a.page,count:l.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,rowsPerPageOptions:[5,15,25,l.length],onRowsPerPageChange:a.onChangeRowsPerPage}),n&&e.jsx(De,{cb:W,dialogProps:{open:n,onClose:()=>o(!1)}})]})]})}const De=({dialogProps:n,cb:o})=>{const{register:t,handleSubmit:i,formState:{isSubmitting:d},control:c}=_();return e.jsx(O,{...n,children:e.jsxs(j,{px:{xs:2,md:4},pb:{xs:3,md:6},pt:{xs:1,md:2},children:[e.jsx(B,{sx:{pl:.5,mb:{xs:1,md:2}},children:"Tạo mức lương cơ sở mới"}),e.jsxs(S,{container:!0,spacing:{xs:0,md:2},children:[e.jsx(S,{item:!0,xs:12,md:6,children:e.jsx(ee,{name:"effectiveDate",control:c,render:({field:l})=>e.jsx(je,{label:"Ngày hiệu lực *",value:J(l.value),onChange:s=>{l.onChange(s)},slotProps:{textField:{onBlur:l.onBlur,name:l.name,inputRef:l.ref}}})})}),e.jsx(S,{item:!0,xs:12,md:6,children:e.jsx(pe,{...t("value"),label:"Mức lương (VNĐ)",placeholder:"Nhập mức lương",fullWidth:!0,required:!0,InputLabelProps:{shrink:!0},sx:{mb:3}})})]}),e.jsxs(A,{sx:{pr:0},children:[e.jsx(v,{variant:"outlined",color:"inherit",startIcon:e.jsx(u,{icon:"codicon:close"}),onClick:l=>{var s;return(s=n.onClose)==null?void 0:s.call(n,l,"backdropClick")},children:"Đóng"}),e.jsx(v,{variant:"contained",startIcon:e.jsx(u,{icon:"material-symbols:add"}),onClick:i(o),disabled:d,children:"Tạo".padEnd(5)})]})]})})};function Te(){const[n,o]=r.useState(0),[t,i]=r.useState("effectiveDate"),[d,c]=r.useState(5),[l,s]=r.useState([]),[p,g]=r.useState("asc"),a=r.useCallback(x=>{g(t===x&&p==="asc"?"desc":"asc"),i(x)},[p,t]),C=r.useCallback((x,b)=>{if(x){s(b);return}s([])},[]),m=r.useCallback(x=>{const b=l.includes(x)?l.filter(R=>R!==x):[...l,x];s(b)},[l]),k=r.useCallback(()=>{o(0)},[]),w=r.useCallback((x,b)=>{o(b)},[]),y=r.useCallback(x=>{c(parseInt(x.target.value,10)),k()},[k]);return{page:n,order:p,onSort:a,orderBy:t,selected:l,rowsPerPage:d,onSelectRow:m,onResetPage:k,onChangePage:w,onSelectAllRows:C,onChangeRowsPerPage:y}}function Ie(){return e.jsx(Y,{children:e.jsx(Pe,{})})}function Xe(){return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:e.jsxs("title",{children:[" ",`Cài đặt hệ thống - ${Z.appName}`]})}),e.jsx(Ie,{})]})}export{Xe as default};
