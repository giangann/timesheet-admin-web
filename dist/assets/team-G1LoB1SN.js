import{j as e,B as C,T as w,d as H,a as p,r,I,P as G,M as L,m as R,b as D,c as S,u as W,e as B,D as $,S as q,H as z}from"./index-CiyAc5l9.js";import{C as X}from"./config-global-ClKwKbZP.js";import{T as v,a as b,b as Q,C as M,c as U,D as A,d as J,e as K,f as Y,g as Z,h as _,i as V}from"./Tooltip-Bw5PYoiz.js";import{O as ee,T as O}from"./TextField-DAHlXdg2.js";import{I as ne}from"./InputAdornment-3JCUqBsx.js";import{u as se}from"./index.esm-CKNsy_kw.js";import{a as te,b as ae,u as oe}from"./use-team-CrauW6BN.js";import{p as re,h as ie}from"./object-util-B_4fPfHZ.js";import{D as N,a as E}from"./dialogTitleClasses-Bswz518M.js";import{G as P,C as le}from"./Grid-DiL9jkRp.js";import"./use-api-CDdvI0gq.js";function ce({emptyRows:n,height:a,sx:t,...i}){return n?e.jsx(v,{sx:{...a&&{height:a*n},...t},...i,children:e.jsx(b,{colSpan:9})}):null}function de({searchQuery:n,...a}){return e.jsx(v,{...a,children:e.jsx(b,{align:"center",colSpan:7,children:e.jsxs(C,{sx:{py:15,textAlign:"center"},children:[e.jsx(w,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(w,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}const he={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function xe(n,a,t){return n?Math.max(0,(1+n)*a-t):0}function F(n,a,t){return a[t]<n[t]?-1:a[t]>n[t]?1:0}function ue(n,a){return n==="desc"?(t,i)=>F(t,i,a):(t,i)=>-F(t,i,a)}function me({inputData:n,comparator:a,filterName:t}){const i=n.map((c,d)=>[c,d]);return i.sort((c,d)=>{const s=a(c[0],d[0]);return s!==0?s:c[1]-d[1]}),n=i.map(c=>c[0]),t&&(n=n.filter(c=>c.name.toLowerCase().indexOf(t.toLowerCase())!==-1)),n}function pe({order:n,onSort:a,orderBy:t,rowCount:i,headLabel:c,numSelected:d,onSelectAllRows:s}){return e.jsx(Q,{children:e.jsxs(v,{children:[e.jsx(b,{padding:"checkbox",children:e.jsx(M,{indeterminate:d>0&&d<i,checked:i>0&&d===i,onChange:l=>s(l.target.checked)})}),c.map(l=>e.jsx(b,{align:l.align||"left",sortDirection:t===l.id?n:!1,sx:{width:l.width,minWidth:l.minWidth},children:e.jsxs(U,{hideSortIcon:!0,active:t===l.id,direction:t===l.id?n:"asc",onClick:()=>a(l.id),children:[l.label,t===l.id?e.jsx(C,{sx:{...he},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))]})})}function ge({numSelected:n,filterName:a,onFilterName:t}){return e.jsx(H,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3),...n>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:n>0?e.jsxs(w,{component:"div",variant:"subtitle1",children:[n," selected"]}):e.jsx(ee,{fullWidth:!0,value:a,onChange:t,placeholder:"Tìm theo tên phòng ban...",startAdornment:e.jsx(ne,{position:"start",children:e.jsx(p,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}})})}function be({row:n,selected:a,onSelectRow:t,onDeleteTeam:i,onGotoDetail:c}){const[d,s]=r.useState(null),[l,x]=r.useState(!1),u=r.useCallback(o=>{s(o.currentTarget)},[]),h=r.useCallback(()=>{s(null)},[]),j=r.useCallback(()=>{x(!0)},[x]),g=r.useCallback(()=>{x(!1)},[x]),f=r.useCallback(()=>{h(),j()},[h,j]),T=r.useCallback(()=>{h(),c(n)},[h,c,n]),k=r.useCallback(()=>{g(),i(n)},[g,i,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(v,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,children:[e.jsx(b,{padding:"checkbox",children:e.jsx(M,{disableRipple:!0,checked:a,onChange:t})}),e.jsx(b,{children:n.name}),e.jsx(b,{children:n.hotline??"-"}),e.jsx(b,{align:"right",children:e.jsx(I,{onClick:u,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(G,{open:!!d,anchorEl:d,onClose:h,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(L,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${R.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${R.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(D,{onClick:T,children:[e.jsx(p,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(D,{onClick:f,sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(N,{open:l,onClose:g,children:e.jsxs(C,{sx:{p:4,pb:4},children:[e.jsxs(C,{position:"relative",children:[e.jsx(A,{sx:{textAlign:"left"},children:"Xác nhận xóa?"}),e.jsx(C,{position:"absolute",top:"15%",right:0,children:e.jsx(J,{title:"Đóng",children:e.jsx(I,{onClick:g,children:e.jsx(p,{icon:"material-symbols:close"})})})})]}),e.jsx(P,{container:!0,rowGap:3,children:e.jsx(P,{item:!0,xs:12,children:e.jsxs(K,{sx:{mb:1},children:["Xác nhận xóa ",n.name,":"]})})}),e.jsxs(E,{children:[e.jsx(S,{variant:"outlined",color:"inherit",startIcon:e.jsx(p,{icon:"codicon:discard"}),onClick:g,children:"Hủy"}),e.jsx(S,{variant:"contained",color:"error",startIcon:e.jsx(p,{icon:"material-symbols:delete"}),onClick:k,children:"Xóa"})]})]})})]})}function je(){const[n,a]=r.useState(!1),[t,i]=r.useState(""),{enqueueSnackbar:c}=W(),d=B(),s=Ce(),{deleteTeamById:l}=te(),{onCreateNewTeam:x}=ae(),{teams:u,onFetchTeams:h}=oe(),j=me({inputData:u,comparator:ue(s.order,s.orderBy),filterName:t}),g=!j.length&&!!t,f=r.useCallback(o=>{d.push(`/phong-ban/${o.id}`)},[d]),T=r.useCallback(async o=>{await l(o.id),h()},[l,h]),k=r.useCallback(async o=>{const m=re(o,["name"]);if(ie(m)){c("Tên không được để trống",{variant:"warning"});return}const y={hotline:o.hotline??"",name:o.name??""};await x(y),h(),a(!1)},[h,x,c,a]);return e.jsxs($,{children:[e.jsxs(C,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(w,{variant:"h4",flexGrow:1,children:"Phòng ban"}),e.jsx(S,{variant:"contained",color:"inherit",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),onClick:()=>a(!0),children:"Thêm mới"})]}),e.jsxs(le,{children:[e.jsx(ge,{numSelected:s.selected.length,filterName:t,onFilterName:o=>{i(o.target.value),s.onResetPage()}}),e.jsx(q,{children:e.jsx(Y,{sx:{overflow:"unset"},children:e.jsxs(Z,{sx:{minWidth:800},children:[e.jsx(pe,{order:s.order,orderBy:s.orderBy,rowCount:u.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:o=>s.onSelectAllRows(o,u.map(m=>m.id.toString())),headLabel:[{id:"name",label:"Tên phòng ban"},{id:"hotline",label:"Hotline"},{id:""}]}),e.jsxs(_,{children:[j.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(o=>e.jsx(be,{row:o,selected:s.selected.includes(o.id.toString()),onSelectRow:()=>s.onSelectRow(o.id.toString()),onDeleteTeam:T,onGotoDetail:f},o.id.toString())),e.jsx(ce,{height:68,emptyRows:xe(s.page,s.rowsPerPage,u.length)}),g&&e.jsx(de,{searchQuery:t})]})]})})}),e.jsx(V,{component:"div",page:s.page,count:u.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,rowsPerPageOptions:[5,15,25,u.length],onRowsPerPageChange:s.onChangeRowsPerPage}),n&&e.jsx(fe,{cb:k,dialogProps:{open:n,onClose:()=>a(!1)}})]})]})}const fe=({dialogProps:n,cb:a})=>{const{register:t,handleSubmit:i,formState:{isSubmitting:c}}=se();return e.jsx(N,{...n,children:e.jsxs(C,{px:{xs:2,md:4},pb:{xs:3,md:6},pt:{xs:1,md:2},children:[e.jsx(A,{sx:{pl:.5,mb:{xs:1,md:2}},children:"Tạo phòng ban mới"}),e.jsxs(P,{container:!0,spacing:{xs:0,md:2},children:[e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(O,{...t("name"),label:"Tên phòng ban",placeholder:"Nhập tên",fullWidth:!0,required:!0,InputLabelProps:{shrink:!0},sx:{mb:3}})}),e.jsx(P,{item:!0,xs:12,md:6,children:e.jsx(O,{...t("hotline"),label:"Hotline",placeholder:"Nhập hotline",fullWidth:!0,InputLabelProps:{shrink:!0},sx:{mb:3}})})]}),e.jsxs(E,{sx:{pr:0},children:[e.jsx(S,{variant:"outlined",color:"inherit",startIcon:e.jsx(p,{icon:"codicon:close"}),onClick:d=>{var s;return(s=n.onClose)==null?void 0:s.call(n,d,"backdropClick")},children:"Đóng"}),e.jsx(S,{variant:"contained",startIcon:e.jsx(p,{icon:"material-symbols:add"}),onClick:i(a),disabled:c,children:"Tạo".padEnd(5)})]})]})})};function Ce(){const[n,a]=r.useState(0),[t,i]=r.useState("name"),[c,d]=r.useState(5),[s,l]=r.useState([]),[x,u]=r.useState("asc"),h=r.useCallback(o=>{u(t===o&&x==="asc"?"desc":"asc"),i(o)},[x,t]),j=r.useCallback((o,m)=>{if(o){l(m);return}l([])},[]),g=r.useCallback(o=>{const m=s.includes(o)?s.filter(y=>y!==o):[...s,o];l(m)},[s]),f=r.useCallback(()=>{a(0)},[]),T=r.useCallback((o,m)=>{a(m)},[]),k=r.useCallback(o=>{d(parseInt(o.target.value,10)),f()},[f]);return{page:n,order:x,onSort:h,orderBy:t,selected:s,rowsPerPage:c,onSelectRow:g,onResetPage:f,onChangePage:T,onSelectAllRows:j,onChangeRowsPerPage:k}}function Fe(){return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("title",{children:[" ",`Phòng ban - ${X.appName}`]})}),e.jsx(je,{})]})}export{Fe as default};
